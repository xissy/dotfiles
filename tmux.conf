setw -g mode-keys vi
set -g mouse on

# Scroll 1 line at a time (default is 5)
bind -T copy-mode-vi WheelUpPane send-keys -X scroll-up
bind -T copy-mode-vi WheelDownPane send-keys -X scroll-down
bind -T copy-mode WheelUpPane send-keys -X scroll-up
bind -T copy-mode WheelDownPane send-keys -X scroll-down
set -g history-limit 10000000

# Alt-h/j/k/l to move panes (no prefix)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Keep window defaults neutral; dimming is handled per-pane via focus hooks below.
set -g window-style 'fg=default,bg=default'
set -g window-active-style 'fg=default,bg=default'
set -g pane-border-style 'fg=colour238'
set -g pane-active-border-style 'fg=green'
set -g pane-border-lines heavy
set -g focus-events on
# Keep bg=default to preserve Ghostty background opacity; dim unfocused panes via fg only.
set-hook -g pane-focus-in 'select-pane -P "nodim,fg=default,bg=default"'
set-hook -g pane-focus-out 'select-pane -P "nodim,fg=colour245,bg=default"'

# Status bar
set -g status-style 'fg=colour250,bg=colour236'
set -g status-left '#[fg=colour245] #S '
set -g status-right '#[fg=colour245]#(echo #{pane_current_path} | sed "s|$HOME|~|") #[fg=colour250]#(cd #{pane_current_path} && git branch --show-current 2>/dev/null || echo "") #[fg=colour243]%a %b %d %H:%M '
set -g status-right-length 120
set -g window-status-current-style 'fg=colour255,bold'
set -g window-status-style 'fg=colour243'
set -g status-interval 5

# Pane splits should open to the same path as the current pane
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

set -s copy-command 'pbcopy'

# Copy mode: y and mouse drag â†’ macOS clipboard
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel

# --- Prefix: keep C-b, add C-a ---
set -g prefix C-b
set -g prefix2 C-a

# To send C-a to the pane/program: press prefix twice
# - C-a C-a: sends actual C-a to current program (e.g. readline's line-beginning)
# - "-2" sends prefix2 (C-a), without it send-prefix sends prefix (C-b)
bind-key C-a send-prefix -2

# Slightly faster prefix response (helps reduce vim+tmux ESC delay)
set -sg escape-time 10
